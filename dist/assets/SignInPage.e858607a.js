import{bz as b,bD as B,bw as p,bU as I,bT as N,bE as e,bR as m}from"./vendor.72204b0d.js";import{u as x,B as D,I as F,b as j,F as c,a as M,M as T,c as k,h as f}from"./index.1ef7901e.js";import"./vant.c7ef435c.js";const q=u=>{const a=b(u);return{ref:a,toggle:()=>a.value=!a.value,on:()=>a.value=!0,off:()=>a.value=!1}},E="_logo_ly99d_1",L="_icon_ly99d_8",R="_appName_ly99d_12",r={logo:E,icon:L,appName:R},P=B({setup:(u,a)=>{const g=x(),t=p({email:"2320035651@qq.com",code:"123456"}),s=p({email:[],code:[]}),i=b(),{ref:_,toggle:U,on:v,off:y}=q(!1),h=I(),C=N(),S=async o=>{var l;if(o.preventDefault(),Object.assign(s,{email:[],code:[]}),!k(s)){const n=await f.post("/session",t,{_autoLoading:!0}).catch(d);localStorage.setItem("jwt",n.data.jwt);const w=(l=C.query.return_to)==null?void 0:l.toString();g.refreshMe(),h.push(w||"/")}},d=o=>{throw o.response.status===422&&Object.assign(s,o.response.data.errors),o},V=async()=>{v(),await f.post("/validation_codes",{email:t.email},{_autoLoading:!0}).catch(d).finally(y),i.value.startCount()};return()=>e(T,null,{title:()=>"\u767B\u5F55",icon:()=>e(D,null,null),default:()=>e("div",{class:r.wrapper},[e("div",{class:r.logo},[e(F,{class:r.icon,name:"plane"},null),e("h1",{class:r.appName},[m("\u591C\u822A\u8BB0\u8D26")])]),e(j,{onSubmit:S},{default:()=>{var o,l;return[e(c,{label:"\u90AE\u7BB1\u5730\u5740",type:"text",placeholder:"\u8BF7\u8F93\u5165\u90AE\u7BB1\uFF0C\u7136\u540E\u70B9\u51FB\u53D1\u9001\u9A8C\u8BC1\u7801",modelValue:t.email,"onUpdate:modelValue":n=>t.email=n,error:(o=s.email)==null?void 0:o[0]},null),e(c,{ref:i,label:"\u9A8C\u8BC1\u7801",type:"validationCode",placeholder:"\u8BF7\u8F93\u5165\u516D\u4F4D\u6570\u5B57",countFrom:1,disabled:_.value,onClick:V,modelValue:t.code,"onUpdate:modelValue":n=>t.code=n,error:(l=s.code)==null?void 0:l[0]},null),e(c,{style:{paddingTop:"96px"}},{default:()=>[e(M,{type:"submit"},{default:()=>[m("\u767B\u5F55")]})]})]}})])})}});export{P as SignInPage};
